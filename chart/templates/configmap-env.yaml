# "{{ required "A valid username for the database is required!" .Values.env.DATABASE_USERNAME }}"
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ template "fusionauth.fullname" . }}-env
  labels:
    heritage: {{ .Release.Name }}
    release: {{ .Release.Name }}
    chart: {{ .Chart.Name }}-{{ .Chart.Version }}
    app: {{ template "fusionauth.name" . }}
data:
  {{- if eq .Values.env.SEARCH_TYPE "elasticsearch" }}
  SEARCH_SERVERS: "{{ .Values.search.protocol }}://{{ include "fusionauth.searchLogin" . }}{{- required "A valid elasticsearch host is required!" .Values.search.host -}}:{{ .Values.search.port }}"
  {{- end }}
  DATABASE_URL: "jdbc:{{ .Values.database.protocol }}://{{- required "A valid database host is required!" .Values.database.host -}}:{{ .Values.database.port }}/{{ .Values.database.name }}{{ include "fusionauth.databaseTLS" . }}"
  {{- if .Values.env }}
  {{- range $key, $value := .Values.env }}
  {{ $key }}: "{{ $value }}"
  {{- end -}}
  {{- end -}}